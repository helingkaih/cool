{"ast":null,"code":"import _classCallCheck from \"F:/qiankun/qiankun-angular/node_modules/@angular-builders/custom-webpack/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"F:/qiankun/qiankun-angular/node_modules/@angular-builders/custom-webpack/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport { Platform, PlatformModule } from '@angular/cdk/platform';\nimport { EventEmitter, Component, ViewEncapsulation, ChangeDetectionStrategy, Inject, ChangeDetectorRef, NgZone, Renderer2, ViewChild, Input, Output, TemplateRef, ElementRef, ContentChild, NgModule } from '@angular/core';\nimport { __decorate, __metadata } from 'tslib';\nimport { DOCUMENT, CommonModule } from '@angular/common';\nimport { NzConfigService, WithConfig } from 'ng-zorro-antd/core/config';\nimport { NzScrollService } from 'ng-zorro-antd/core/services';\nimport { InputBoolean, InputNumber } from 'ng-zorro-antd/core/util';\nimport { Subject, fromEvent } from 'rxjs';\nimport { throttleTime, takeUntil } from 'rxjs/operators';\nimport { BidiModule } from '@angular/cdk/bidi';\nimport { NzAffixModule } from 'ng-zorro-antd/affix';\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\nimport * as ɵngcc0 from '@angular/core';\nimport * as ɵngcc1 from 'ng-zorro-antd/core/config';\nimport * as ɵngcc2 from 'ng-zorro-antd/core/services';\nimport * as ɵngcc3 from '@angular/cdk/platform';\nimport * as ɵngcc4 from '@angular/common';\nimport * as ɵngcc5 from 'ng-zorro-antd/affix';\nvar _c0 = [\"ink\"];\n\nfunction NzAnchorComponent_nz_affix_0_ng_template_1_Template(rf, ctx) {}\n\nfunction NzAnchorComponent_nz_affix_0_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"nz-affix\", 2);\n    ɵngcc0.ɵɵtemplate(1, NzAnchorComponent_nz_affix_0_ng_template_1_Template, 0, 0, \"ng-template\", 3);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r0 = ɵngcc0.ɵɵnextContext();\n\n    var _r1 = ɵngcc0.ɵɵreference(2);\n\n    ɵngcc0.ɵɵproperty(\"nzOffsetTop\", ctx_r0.nzOffsetTop)(\"nzTarget\", ctx_r0.container);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngTemplateOutlet\", _r1);\n  }\n}\n\nvar _c1 = function _c1(a0) {\n  return {\n    fixed: a0\n  };\n};\n\nfunction NzAnchorComponent_ng_template_1_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"div\", 4);\n    ɵngcc0.ɵɵelementStart(1, \"div\", 5);\n    ɵngcc0.ɵɵelementStart(2, \"div\", 6);\n    ɵngcc0.ɵɵelement(3, \"div\", 7, 8);\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵprojection(5);\n    ɵngcc0.ɵɵelementEnd();\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r2 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵproperty(\"ngStyle\", ctx_r2.wrapperStyle);\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵproperty(\"ngClass\", ɵngcc0.ɵɵpureFunction1(2, _c1, !ctx_r2.nzAffix && !ctx_r2.nzShowInkInFixed));\n  }\n}\n\nvar _c2 = [\"*\"];\nvar _c3 = [\"nzTemplate\"];\nvar _c4 = [\"linkTitle\"];\n\nfunction NzAnchorLinkComponent_span_2_Template(rf, ctx) {\n  if (rf & 1) {\n    ɵngcc0.ɵɵelementStart(0, \"span\");\n    ɵngcc0.ɵɵtext(1);\n    ɵngcc0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r1 = ɵngcc0.ɵɵnextContext();\n    ɵngcc0.ɵɵadvance(1);\n    ɵngcc0.ɵɵtextInterpolate(ctx_r1.titleStr);\n  }\n}\n\nfunction getOffsetTop(element, container) {\n  if (!element || !element.getClientRects().length) {\n    return 0;\n  }\n\n  var rect = element.getBoundingClientRect();\n\n  if (rect.width || rect.height) {\n    if (container === window) {\n      var documentElement = element.ownerDocument.documentElement;\n      return rect.top - documentElement.clientTop;\n    }\n\n    return rect.top - container.getBoundingClientRect().top;\n  }\n\n  return rect.top;\n}\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\n\nvar NZ_CONFIG_MODULE_NAME = 'anchor';\nvar sharpMatcherRegx = /#([^#]+)$/;\n\nvar NzAnchorComponent = /*@__PURE__*/function () {\n  var NzAnchorComponent = /*#__PURE__*/function () {\n    function NzAnchorComponent(doc, nzConfigService, scrollSrv, cdr, platform, zone, renderer) {\n      _classCallCheck(this, NzAnchorComponent);\n\n      this.doc = doc;\n      this.nzConfigService = nzConfigService;\n      this.scrollSrv = scrollSrv;\n      this.cdr = cdr;\n      this.platform = platform;\n      this.zone = zone;\n      this.renderer = renderer;\n      this._nzModuleName = NZ_CONFIG_MODULE_NAME;\n      this.nzAffix = true;\n      this.nzShowInkInFixed = false;\n      this.nzBounds = 5;\n      this.nzOffsetTop = undefined;\n      this.nzClick = new EventEmitter();\n      this.nzScroll = new EventEmitter();\n      this.visible = false;\n      this.wrapperStyle = {\n        'max-height': '100vh'\n      };\n      this.links = [];\n      this.animating = false;\n      this.destroy$ = new Subject();\n      this.handleScrollTimeoutID = -1;\n    }\n\n    _createClass(NzAnchorComponent, [{\n      key: \"registerLink\",\n      value: function registerLink(link) {\n        this.links.push(link);\n      }\n    }, {\n      key: \"unregisterLink\",\n      value: function unregisterLink(link) {\n        this.links.splice(this.links.indexOf(link), 1);\n      }\n    }, {\n      key: \"getContainer\",\n      value: function getContainer() {\n        return this.container || window;\n      }\n    }, {\n      key: \"ngAfterViewInit\",\n      value: function ngAfterViewInit() {\n        this.registerScrollEvent();\n      }\n    }, {\n      key: \"ngOnDestroy\",\n      value: function ngOnDestroy() {\n        clearTimeout(this.handleScrollTimeoutID);\n        this.destroy$.next();\n        this.destroy$.complete();\n      }\n    }, {\n      key: \"registerScrollEvent\",\n      value: function registerScrollEvent() {\n        var _this = this;\n\n        if (!this.platform.isBrowser) {\n          return;\n        }\n\n        this.destroy$.next();\n        this.zone.runOutsideAngular(function () {\n          fromEvent(_this.getContainer(), 'scroll').pipe(throttleTime(50), takeUntil(_this.destroy$)).subscribe(function () {\n            return _this.handleScroll();\n          });\n        }); // Browser would maintain the scrolling position when refreshing.\n        // So we have to delay calculation in avoid of getting a incorrect result.\n\n        this.handleScrollTimeoutID = setTimeout(function () {\n          return _this.handleScroll();\n        });\n      }\n    }, {\n      key: \"handleScroll\",\n      value: function handleScroll() {\n        var _this2 = this;\n\n        if (typeof document === 'undefined' || this.animating) {\n          return;\n        }\n\n        var sections = [];\n        var scope = (this.nzOffsetTop || 0) + this.nzBounds;\n        this.links.forEach(function (comp) {\n          var sharpLinkMatch = sharpMatcherRegx.exec(comp.nzHref.toString());\n\n          if (!sharpLinkMatch) {\n            return;\n          }\n\n          var target = _this2.doc.getElementById(sharpLinkMatch[1]);\n\n          if (target) {\n            var top = getOffsetTop(target, _this2.getContainer());\n\n            if (top < scope) {\n              sections.push({\n                top: top,\n                comp: comp\n              });\n            }\n          }\n        });\n        this.visible = !!sections.length;\n\n        if (!this.visible) {\n          this.clearActive();\n          this.cdr.detectChanges();\n        } else {\n          var maxSection = sections.reduce(function (prev, curr) {\n            return curr.top > prev.top ? curr : prev;\n          });\n          this.handleActive(maxSection.comp);\n        }\n\n        this.setVisible();\n      }\n    }, {\n      key: \"clearActive\",\n      value: function clearActive() {\n        this.links.forEach(function (i) {\n          i.unsetActive();\n        });\n      }\n    }, {\n      key: \"handleActive\",\n      value: function handleActive(comp) {\n        this.clearActive();\n        comp.setActive();\n        var linkNode = comp.getLinkTitleElement();\n        this.ink.nativeElement.style.top = \"\".concat(linkNode.offsetTop + linkNode.clientHeight / 2 - 4.5, \"px\");\n        this.visible = true;\n        this.setVisible();\n        this.nzScroll.emit(comp);\n      }\n    }, {\n      key: \"setVisible\",\n      value: function setVisible() {\n        var visible = this.visible;\n        var visibleClassname = 'visible';\n\n        if (this.ink) {\n          if (visible) {\n            this.renderer.addClass(this.ink.nativeElement, visibleClassname);\n          } else {\n            this.renderer.removeClass(this.ink.nativeElement, visibleClassname);\n          }\n        }\n      }\n    }, {\n      key: \"handleScrollTo\",\n      value: function handleScrollTo(linkComp) {\n        var _this3 = this;\n\n        var el = this.doc.querySelector(linkComp.nzHref);\n\n        if (!el) {\n          return;\n        }\n\n        this.animating = true;\n        var containerScrollTop = this.scrollSrv.getScroll(this.getContainer());\n        var elOffsetTop = getOffsetTop(el, this.getContainer());\n        var targetScrollTop = containerScrollTop + elOffsetTop - (this.nzOffsetTop || 0);\n        this.scrollSrv.scrollTo(this.getContainer(), targetScrollTop, {\n          callback: function callback() {\n            _this3.animating = false;\n\n            _this3.handleActive(linkComp);\n          }\n        });\n        this.nzClick.emit(linkComp.nzHref);\n      }\n    }, {\n      key: \"ngOnChanges\",\n      value: function ngOnChanges(changes) {\n        var nzOffsetTop = changes.nzOffsetTop,\n            nzContainer = changes.nzContainer;\n\n        if (nzOffsetTop) {\n          this.wrapperStyle = {\n            'max-height': \"calc(100vh - \".concat(this.nzOffsetTop, \"px)\")\n          };\n        }\n\n        if (nzContainer) {\n          var container = this.nzContainer;\n          this.container = typeof container === 'string' ? this.doc.querySelector(container) : container;\n          this.registerScrollEvent();\n        }\n      }\n    }]);\n\n    return NzAnchorComponent;\n  }();\n\n  NzAnchorComponent.ɵfac = function NzAnchorComponent_Factory(t) {\n    return new (t || NzAnchorComponent)(ɵngcc0.ɵɵdirectiveInject(DOCUMENT), ɵngcc0.ɵɵdirectiveInject(ɵngcc1.NzConfigService), ɵngcc0.ɵɵdirectiveInject(ɵngcc2.NzScrollService), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.Platform), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.NgZone), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2));\n  };\n\n  NzAnchorComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({\n    type: NzAnchorComponent,\n    selectors: [[\"nz-anchor\"]],\n    viewQuery: function NzAnchorComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵviewQuery(_c0, 1);\n      }\n\n      if (rf & 2) {\n        var _t;\n\n        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.ink = _t.first);\n      }\n    },\n    inputs: {\n      nzAffix: \"nzAffix\",\n      nzShowInkInFixed: \"nzShowInkInFixed\",\n      nzBounds: \"nzBounds\",\n      nzOffsetTop: \"nzOffsetTop\",\n      nzContainer: \"nzContainer\"\n    },\n    outputs: {\n      nzClick: \"nzClick\",\n      nzScroll: \"nzScroll\"\n    },\n    exportAs: [\"nzAnchor\"],\n    features: [ɵngcc0.ɵɵNgOnChangesFeature],\n    ngContentSelectors: _c2,\n    decls: 3,\n    vars: 2,\n    consts: [[3, \"nzOffsetTop\", \"nzTarget\", 4, \"ngIf\", \"ngIfElse\"], [\"content\", \"\"], [3, \"nzOffsetTop\", \"nzTarget\"], [3, \"ngTemplateOutlet\"], [1, \"ant-anchor-wrapper\", 3, \"ngStyle\"], [1, \"ant-anchor\", 3, \"ngClass\"], [1, \"ant-anchor-ink\"], [1, \"ant-anchor-ink-ball\"], [\"ink\", \"\"]],\n    template: function NzAnchorComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵprojectionDef();\n        ɵngcc0.ɵɵtemplate(0, NzAnchorComponent_nz_affix_0_Template, 2, 3, \"nz-affix\", 0);\n        ɵngcc0.ɵɵtemplate(1, NzAnchorComponent_ng_template_1_Template, 6, 4, \"ng-template\", null, 1, ɵngcc0.ɵɵtemplateRefExtractor);\n      }\n\n      if (rf & 2) {\n        var _r1 = ɵngcc0.ɵɵreference(2);\n\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.nzAffix)(\"ngIfElse\", _r1);\n      }\n    },\n    directives: [ɵngcc4.NgIf, ɵngcc5.NzAffixComponent, ɵngcc4.NgTemplateOutlet, ɵngcc4.NgStyle, ɵngcc4.NgClass],\n    encapsulation: 2,\n    changeDetection: 0\n  });\n\n  __decorate([InputBoolean(), __metadata(\"design:type\", Object)], NzAnchorComponent.prototype, \"nzAffix\", void 0);\n\n  __decorate([WithConfig(), InputBoolean(), __metadata(\"design:type\", Boolean)], NzAnchorComponent.prototype, \"nzShowInkInFixed\", void 0);\n\n  __decorate([WithConfig(), InputNumber(), __metadata(\"design:type\", Number)], NzAnchorComponent.prototype, \"nzBounds\", void 0);\n\n  __decorate([InputNumber(undefined), WithConfig(), __metadata(\"design:type\", Number)], NzAnchorComponent.prototype, \"nzOffsetTop\", void 0);\n\n  return NzAnchorComponent;\n}();\n\nvar NzAnchorLinkComponent = /*@__PURE__*/function () {\n  var NzAnchorLinkComponent = /*#__PURE__*/function () {\n    function NzAnchorLinkComponent(elementRef, anchorComp, platform, renderer) {\n      _classCallCheck(this, NzAnchorLinkComponent);\n\n      this.elementRef = elementRef;\n      this.anchorComp = anchorComp;\n      this.platform = platform;\n      this.renderer = renderer;\n      this.nzHref = '#';\n      this.titleStr = '';\n      this.renderer.addClass(elementRef.nativeElement, 'ant-anchor-link');\n    }\n\n    _createClass(NzAnchorLinkComponent, [{\n      key: \"nzTitle\",\n      set: function set(value) {\n        if (value instanceof TemplateRef) {\n          this.titleStr = null;\n          this.titleTpl = value;\n        } else {\n          this.titleStr = value;\n        }\n      }\n    }, {\n      key: \"ngOnInit\",\n      value: function ngOnInit() {\n        this.anchorComp.registerLink(this);\n      }\n    }, {\n      key: \"getLinkTitleElement\",\n      value: function getLinkTitleElement() {\n        return this.linkTitle.nativeElement;\n      }\n    }, {\n      key: \"setActive\",\n      value: function setActive() {\n        this.renderer.addClass(this.elementRef.nativeElement, 'ant-anchor-link-active');\n      }\n    }, {\n      key: \"unsetActive\",\n      value: function unsetActive() {\n        this.renderer.removeClass(this.elementRef.nativeElement, 'ant-anchor-link-active');\n      }\n    }, {\n      key: \"goToClick\",\n      value: function goToClick(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        if (this.platform.isBrowser) {\n          this.anchorComp.handleScrollTo(this);\n        }\n      }\n    }, {\n      key: \"ngOnDestroy\",\n      value: function ngOnDestroy() {\n        this.anchorComp.unregisterLink(this);\n      }\n    }]);\n\n    return NzAnchorLinkComponent;\n  }();\n\n  NzAnchorLinkComponent.ɵfac = function NzAnchorLinkComponent_Factory(t) {\n    return new (t || NzAnchorLinkComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(NzAnchorComponent), ɵngcc0.ɵɵdirectiveInject(ɵngcc3.Platform), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2));\n  };\n\n  NzAnchorLinkComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({\n    type: NzAnchorLinkComponent,\n    selectors: [[\"nz-link\"]],\n    contentQueries: function NzAnchorLinkComponent_ContentQueries(rf, ctx, dirIndex) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵcontentQuery(dirIndex, _c3, 1);\n      }\n\n      if (rf & 2) {\n        var _t;\n\n        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.nzTemplate = _t.first);\n      }\n    },\n    viewQuery: function NzAnchorLinkComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵviewQuery(_c4, 1);\n      }\n\n      if (rf & 2) {\n        var _t;\n\n        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.linkTitle = _t.first);\n      }\n    },\n    inputs: {\n      nzHref: \"nzHref\",\n      nzTitle: \"nzTitle\"\n    },\n    exportAs: [\"nzLink\"],\n    ngContentSelectors: _c2,\n    decls: 4,\n    vars: 4,\n    consts: [[1, \"ant-anchor-link-title\", 3, \"href\", \"title\", \"click\"], [\"linkTitle\", \"\"], [4, \"ngIf\", \"ngIfElse\"]],\n    template: function NzAnchorLinkComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        ɵngcc0.ɵɵprojectionDef();\n        ɵngcc0.ɵɵelementStart(0, \"a\", 0, 1);\n        ɵngcc0.ɵɵlistener(\"click\", function NzAnchorLinkComponent_Template_a_click_0_listener($event) {\n          return ctx.goToClick($event);\n        });\n        ɵngcc0.ɵɵtemplate(2, NzAnchorLinkComponent_span_2_Template, 2, 1, \"span\", 2);\n        ɵngcc0.ɵɵelementEnd();\n        ɵngcc0.ɵɵprojection(3);\n      }\n\n      if (rf & 2) {\n        ɵngcc0.ɵɵpropertyInterpolate(\"href\", ctx.nzHref, ɵngcc0.ɵɵsanitizeUrl);\n        ɵngcc0.ɵɵpropertyInterpolate(\"title\", ctx.titleStr);\n        ɵngcc0.ɵɵadvance(2);\n        ɵngcc0.ɵɵproperty(\"ngIf\", ctx.titleStr)(\"ngIfElse\", ctx.titleTpl || ctx.nzTemplate);\n      }\n    },\n    directives: [ɵngcc4.NgIf],\n    encapsulation: 2,\n    changeDetection: 0\n  });\n  return NzAnchorLinkComponent;\n}();\n\nvar NzAnchorModule = /*@__PURE__*/function () {\n  var NzAnchorModule = function NzAnchorModule() {\n    _classCallCheck(this, NzAnchorModule);\n  };\n\n  NzAnchorModule.ɵfac = function NzAnchorModule_Factory(t) {\n    return new (t || NzAnchorModule)();\n  };\n\n  NzAnchorModule.ɵmod = ɵngcc0.ɵɵdefineNgModule({\n    type: NzAnchorModule\n  });\n  NzAnchorModule.ɵinj = ɵngcc0.ɵɵdefineInjector({\n    imports: [[BidiModule, CommonModule, NzAffixModule, PlatformModule]]\n  });\n  return NzAnchorModule;\n}();\n\n(function () {\n  (typeof ngJitMode === \"undefined\" || ngJitMode) && ɵngcc0.ɵɵsetNgModuleScope(NzAnchorModule, {\n    declarations: function declarations() {\n      return [NzAnchorComponent, NzAnchorLinkComponent];\n    },\n    imports: function imports() {\n      return [BidiModule, CommonModule, NzAffixModule, PlatformModule];\n    },\n    exports: function exports() {\n      return [NzAnchorComponent, NzAnchorLinkComponent];\n    }\n  });\n})();\n/**\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://github.com/NG-ZORRO/ng-zorro-antd/blob/master/LICENSE\n */\n\n/**\n * Generated bundle index. Do not edit.\n */\n\n\nexport { NzAnchorComponent, NzAnchorLinkComponent, NzAnchorModule }; //# sourceMappingURL=ng-zorro-antd-anchor.js.map","map":null,"metadata":{},"sourceType":"module"}